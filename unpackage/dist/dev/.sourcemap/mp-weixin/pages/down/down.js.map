{"version":3,"sources":["uni-app:///main.js","webpack:///D:/wwwroot/APP/uniApp/V3长视频/MS_V3/pages/down/down.vue?5924","webpack:///D:/wwwroot/APP/uniApp/V3长视频/MS_V3/pages/down/down.vue?07fb","webpack:///D:/wwwroot/APP/uniApp/V3长视频/MS_V3/pages/down/down.vue?f1fd","webpack:///D:/wwwroot/APP/uniApp/V3长视频/MS_V3/pages/down/down.vue?faa9","uni-app:///pages/down/down.vue","webpack:///D:/wwwroot/APP/uniApp/V3长视频/MS_V3/pages/down/down.vue?c662","webpack:///D:/wwwroot/APP/uniApp/V3长视频/MS_V3/pages/down/down.vue?caff"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,yF;AACAA,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;AACa;;;AAGhE;AACqL;AACrL,gBAAgB,sLAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA2rB,CAAgB,2pBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC8D/sB,iF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,U,eACA,EACA,IADA,kBACA,CACA,SACA,aADA,EAEA,SACA,oBADA,EAEA,YAFA,EAGA,eAHA,EAFA,EAOA;AACA,kBARA,EASA;AACA,eAVA,EAWA,gBAXA,EAYA,eAZA,EAaA,WAbA,EAcA,UAdA,EAeA,aAfA,EAiBA,UAjBA,GAmBA,CArBA,EAsBA,MAtBA,oBAsBA,CACA,aACA,uBACA,iDAHA,CAIA;AACA,wCACA,qBACA,gBACA,CAFA,MAEA,CACA,2BACA,CACA,uBACA,wBACA,CAnCA,EAoCA,MApCA,oBAoCA,CACA,iBACA,CAtCA,EAuCA,MAvCA,oBAuCA,CACA,sCACA,CAzCA,EA0CA,WACA,eADA,6BACA,CACA;;;;;;;kVAQA,CAVA,EAWA,cAXA,4BAWA,CACA,kCACA,2BAFA,CAGA;AACA,uBACA,mBADA,EAEA,gCACA,4CADA,CAEA;AACA,SALA,EAMA,+BACA,oBACA,CARA,IAUA,CAzBA,EA0BA,SA1BA,uBA0BA,CACA,4BADA,CAEA;AACA;;;;;;;;;;;;;;;;;;;YAoBA;AACA;AACA,4BADA;AAEA,qBAFA;AAGA,iCAHA;AAIA,oDAJA;AAKA,6FALA;AAMA,wBANA;;AAQA;AACA;AACA;AACA,KA7DA;AA8DA;AACA,eA/DA,yBA+DA;AACA;AACA;AACA,0BADA;AAEA,uEAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAFA;AAGA;AACA;AACA;AACA;AACA,WAVA,MAUA;AACA;AACA;AACA;AACA;AACA,SAvBA;AAwBA;AACA;AACA;AACA,SA3BA;;AA6BA,KA9FA;AA+FA;AACA,aAhGA,qBAgGA,IAhGA,EAgGA,CAhGA,EAgGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BADA;AAEA,gEAFA;AAGA,kCAHA;AAIA,mCAJA;AAKA;AACA;AACA;AACA,mBAFA,MAEA;AACA;AACA;AACA;AACA,iBAZA,IAfA;;;AA8BA,SAhCA;;AAkCA,KArIA;AAsIA;AACA,aAvIA,qBAuIA,IAvIA,EAuIA,KAvIA,EAuIA,GAvIA,EAuIA,MAvIA,EAuIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAhJA;AAiJA,aAjJA,uBAiJA;AACA;AACA;AACA;AACA,KArJA;AAsJA,cAtJA,wBAsJA;AACA;AACA,KAxJA;AAyJA;AACA,gBA1JA,wBA0JA,OA1JA,EA0JA,CA1JA,EA0JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAVA;;AAYA;AACA,WAnBA,MAmBA;AACA;AACA;AACA;AACA;AACA;AACA,SA7BA;AA8BA;AACA;AACA;AACA;AACA;AACA,SAnCA;;AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAZA;AAaA,KApNA;AAqNA;AACA,YAtNA,oBAsNA,GAtNA,EAsNA,CAtNA,EAsNA,OAtNA,EAsNA,UAtNA,EAsNA;AACA;AACA,mBADA;AAEA,0BAFA;AAGA,yBAHA;AAIA,2BAJA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAPA,MAOA;AACA;AACA;AACA,SAhBA;;AAkBA,KAzOA;AA0OA;AACA,WA3OA,qBA2OA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KAjPA;AAkPA;AACA,WAnPA,qBAmPA;AACA;AACA;AACA,mBADA;AAEA,oBAFA;AAGA,kBAHA;AAIA,uBAJA;;AAMA,KA3PA,EA1CA;;AAuSA;AACA,mBAxSA,+BAwSA;AACA;AACA;AACA,GA3SA,E;;;;;;;;;;;;;AChEA;AAAA;AAAA;AAAA;AAAk/B,CAAgB,k6BAAG,EAAC,C;;;;;;;;;;;ACAtgC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/down/down.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/down/down.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./down.vue?vue&type=template&id=53b6ab74&\"\nvar renderjs\nimport script from \"./down.vue?vue&type=script&lang=js&\"\nexport * from \"./down.vue?vue&type=script&lang=js&\"\nimport style0 from \"./down.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/down/down.vue\"\nexport default component.exports","export * from \"-!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./down.vue?vue&type=template&id=53b6ab74&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./down.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./down.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"bg\"> \r\n\t\t<view class=\"video-list\">\r\n\t\t\t\r\n\t\t\t<view :class=\"v.downstatus?'video-info ok':'video-info no'\" \r\n\t\t\tv-if=\"v.delstatus\"\r\n\t\t\tv-for=\"(v, i) in downList\"\r\n\t\t\t:key=\"i\">\r\n\t\t\t\t<view class=\"img\" @click=\"playVideo(v.downstatus, v.videotitle, v.videourl, v.poster)\">\r\n\t\t\t\t\t<image class=\"pic\" :src=\"v.poster\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<image class=\"play\" src=\"@/static/imgs/play.png\" mode=\"aspectFill\" v-if=\"v.downstatus\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"video-content\">\r\n\t\t\t\t\t<image class=\"bgx\" src=\"@/static/imgs/delx.png\" mode=\"aspectFill\" @click=\"delVideo(v.videoid,i,v.videourl,v.downstatus)\"></image>\r\n\t\t\t\t\t<view class=\"video-title\">{{v.videotitle}}</view>\r\n\t\t\t\t\t<view v-if=\"v.downstatus\">\r\n\t\t\t\t\t\t<view class=\"video-kb\">\r\n\t\t\t\t\t\t\t<view style=\"margin-left:2px;\">已下载完成</view>\r\n\t\t\t\t\t\t\t<view style=\"float:right;margin-right:1px;\">{{v.videosize}}M</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"video-lenght\">\r\n\t\t\t\t\t\t\t<view class=\"video-lenght-ing\" style=\"width:100%\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-else>\r\n\t\t\t\t\t\t<view class=\"video-kb\">\r\n\t\t\t\t\t\t\t<view style=\"margin-left:2px;\">{{v.downkb}}</view>\r\n\t\t\t\t\t\t\t<view style=\"float:right;margin-right:2px;\">{{v.downsize}}M/{{v.videosize}}M</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"video-lenght\">\r\n\t\t\t\t\t\t\t<view class=\"video-lenght-ing\" :style=\"{ width: v.videoing +'%' }\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<image class=\"start-down\" src=\"@/static/imgs/download_sel.png\" @click=\"startDown(v.videourl, i)\" v-if=\"v.starttostop\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<!--暂无数据-->\r\n\t\t\t<view style=\"width:100%;height:500upx;margin-top:45%;text-align:center;\" v-if=\"isShowTig\">\r\n\t\t\t\t<image src=\"@/static/imgs/nodata.png\" style=\"width:280upx;height:180upx;\"></image>\r\n\t\t\t\t<view style=\"width:100%;font-size:25upx;color:#666;margin-top:30upx;\">您还没有下载过视频，快去下载一部试试吧</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- <view @click=\"downVideo\" style=\"margin-top:20px;text-align:center;\">添加下载任务</view> -->\r\n\t\t</view>\r\n\t\t<!--弹出播放器start-->\r\n\t\t<view class=\"video\" v-if=\"isPlay\">\r\n\t\t\t<view class=\"play-title\">{{video.videoTitle}}</view>\r\n\t\t\t<video\r\n\t\t\t\t:src=\"video.videoUrl\"\r\n\t\t\t\t:poster=\"video.videoPoster\"\r\n\t\t\t\t:autoplay=\"true\"\r\n\t\t\t\t:title=\"video.videoTitle\"\r\n\t\t\t\t@error=\"videoError\">\r\n\t\t\t</video>\r\n\t\t\t<view class=\"play-close\" @click=\"playClose\">\r\n\t\t\t\t<image src=\"@/static/imgs/delx.png\"></image>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!--弹出播放器end-->\r\n\t</view>\n</template>\n\n<script>\r\nimport api from \"@/common/api.js\";\r\nvar _self;\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tisPlay: false,\r\n\t\t\tvideo: {\r\n\t\t\t\tvideoTitle: '加载中...',\r\n\t\t\t\tvideoUrl: '',\r\n\t\t\t\tvideoPoster: ''\r\n\t\t\t},\r\n\t\t\t// 下载列表\r\n\t\t\tdownList: {},\r\n\t\t\t// 会员ID\r\n\t\t\tuserId: 0,\r\n\t\t\tisShowTig: false,\r\n\t\t\tdbName: 'video',\r\n\t\t\tvideoNum: 0,\r\n\t\t\tdownNum: 5,\r\n\t\t\tdownBigNum: 5,\r\n\t\t\t\r\n\t\t\tone: false,\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\t_self = this;\r\n\t\t_self.dbName = 'video';\r\n\t\tuni.showLoading({ title:'加载中...',mask:true });\r\n\t\t// 是否登录\r\n\t\tvar info = api.getLogins();\r\n\t\tif(info === false) {\r\n\t\t\t_self.skipUrl();\r\n\t\t}else{\r\n\t\t\t_self.userId = info.userId;\r\n\t\t}\r\n\t\t_self.getDownListNum();\r\n\t\t_self.getNetworkTypes();\r\n\t},\r\n\tonHide() {\r\n\t\t_self.one = true;\r\n\t},\r\n\tonShow() {\r\n\t\tif(_self.one) _self.getDownListNum();\r\n\t},\r\n\tmethods: {\r\n\t\tgetNetworkTypes() {\r\n\t\t\t/* const value = uni.getStorageSync('init_' + api.appkey);\r\n\t\t\tif (value) {\r\n\t\t\t\tuni.hideTabBar({\r\n\t\t\t\t\tsuccess: (e)=> {\r\n\t\t\t\t\t\t//console.log(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} */\r\n\t\t},\r\n\t\tgetDownListNum() {\r\n\t\t\tapi.openDb(_self.dbName);\r\n\t\t\tapi.createTable();\r\n\t\t\t//var mobile = uni.getSystemInfoSync();\r\n\t\t\tuni.getStorage({\r\n\t\t\t    key: 'download_num',\r\n\t\t\t    success: (res)=> {\r\n\t\t\t\t\t_self.downNum = _self.downBigNum = res.data;\r\n\t\t\t        //console.log(_self.downNum);\r\n\t\t\t    },\r\n\t\t\t\tcomplete: ()=> {\r\n\t\t\t\t\t_self.getDownList();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tdownVideo(){\r\n\t\t\t/* ======添加视频下载任务示例=====s */\r\n\t\t\t// 获取文件大小\r\n\t\t\t/* uni.request({\r\n\t\t\t\turl: 'http://v.mscms.cc/test2.mp4',\r\n\t\t\t\tmethod: 'HEAD',\r\n\t\t\t\tsuccess: (e) => {\r\n\t\t\t\t\tif(e.statusCode==200){\r\n\t\t\t\t\t\tvar videoSize = e.header;\r\n\t\t\t\t\t\t// 调用函数换算单位\r\n\t\t\t\t\t\tvar resSize = api.getFileSize(videoSize['Content-Length']);\r\n\t\t\t\t\t\tif(resSize){\r\n\t\t\t\t\t\t\tconsole.log(resSize);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t_self.msgData('服务器连接失败，请检查网络是否正常', 3000);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: () => {\r\n\t\t\t\t\t// 加载失败提示\r\n\t\t\t\t\t_self.msgData('服务器连接失败，请检查网络是否正常', 3000);\r\n\t\t\t\t}\r\n\t\t\t}); */\r\n\t\t\tvar rand = api.randomWord(true,true,1,5);\r\n\t\t\tvar data = {\r\n\t\t\t\tuserId: _self.userId,\r\n\t\t\t\tvideoId: rand,\r\n\t\t\t\tvideoTitle: '测试视频'+rand,\r\n\t\t\t\tvideoUrl: 'http://v3.yunkupay.net/test1.mp4',\r\n\t\t\t\tposter: 'https://img.sokoyo-rj.com/tuku/upload/vod/2020-10-31/202010311604113932.jpg',\r\n\t\t\t\tvideoSize: 26.21,\r\n\t\t\t};\r\n\t\t\tapi.downVideo(data);\r\n\t\t\t_self.msgData('OK', 1000);\r\n\t\t\t/* ======添加视频下载任务示例=====e */\r\n\t\t},\r\n\t\t// 下载列表\r\n\t\tgetDownList() {\r\n\t\t\t//console.log(1);\r\n\t\t\tplus.sqlite.selectSql({\r\n\t\t\t\tname: _self.dbName,\r\n\t\t\t\tsql: 'select * from downVideoList where userid='+_self.userId,\r\n\t\t\t\tsuccess: (data)=>{\r\n\t\t\t\t\t//console.log(data);\r\n\t\t\t\t\t//for(var i in data){\r\n\t\t\t\t\t//\tconsole.log(data[i]);\r\n\t\t\t\t\t//}\r\n\t\t\t\t\tif(data.length > 0){\r\n\t\t\t\t\t\tvar downList = data;\r\n\t\t\t\t\t\tfor (var i = 0; i < downList.length; i++) {\r\n\t\t\t\t\t\t\tapi.imgCache(downList[i].poster, (isImg)=> {\r\n\t\t\t\t\t\t\t\tdownList[i].poster = isImg;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_self.downList = downList;\r\n\t\t\t\t\t\t_self.videoNum = data.length;\r\n\t\t\t\t\t\t_self.isShowTig = false;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t_self.downList = {};\r\n\t\t\t\t\t\t_self.isShowTig = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t},\r\n\t\t\t\tfail: (e)=>{\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tconsole.log('查询错误: '+JSON.stringify(e));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 开始下载\r\n\t\tstartDown(down, i) {\r\n\t\t\tuni.showLoading({ title:'处理中...',mask:true });\r\n\t\t\t// 检测网格状态\r\n\t\t\tuni.getNetworkType({\r\n\t\t\t    success: function (res) {\r\n\t\t\t\t\tswitch(res.networkType) {\r\n\t\t\t\t\t    case 'none': // 无网络\r\n\t\t\t\t\t        _self.msgData('服务器连接失败，请检查网络是否正常', 2000);\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t        break;\r\n\t\t\t\t\t\tcase 'wifi': // 无线\r\n\t\t\t\t\t\t\t_self.addDownVideo(down, i);\r\n\t\t\t\t\t\t   break;\r\n\t\t\t\t\t\tcase 'ethernet': // 有线\r\n\t\t\t\t\t\t\t_self.addDownVideo(down, i);\r\n\t\t\t\t\t\t   break;\r\n\t\t\t\t\t\tcase 'unknown': // Android 下不常见的网络类型\r\n\t\t\t\t\t\t\t_self.addDownVideo(down, i);\r\n\t\t\t\t\t\t   break;   \r\n\t\t\t\t\t    default:\r\n\t\t\t\t\t        uni.showModal({\r\n\t\t\t\t\t            title: '温馨提示',\r\n\t\t\t\t\t            content: '当前网络为：'+res.networkType+'，确定要下载吗？',\r\n\t\t\t\t\t        \tcancelText: '暂不下载',\r\n\t\t\t\t\t        \tconfirmText: '我是土豪',\r\n\t\t\t\t\t            success: (res)=> {\r\n\t\t\t\t\t\t\t\t\tif(res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t_self.addDownVideo(down, i);\r\n\t\t\t\t\t\t\t\t\t} else if (res.cancel) {\r\n\t\t\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\t\t\t//console.log('用户点击取消');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t            }\r\n\t\t\t\t\t        });\r\n\t\t\t\t\t}\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 离线播放视频\r\n\t\tplayVideo(type, title, url, poster) {\r\n\t\t\tuni.showLoading({ title:'加载中...',mask:true });\r\n\t\t\tif(type){\r\n\t\t\t\t_self.video.videoUrl = url;\r\n\t\t\t\t_self.video.videoTitle = title;\r\n\t\t\t\t_self.video.videoPoster = poster;\r\n\t\t\t\t_self.isPlay = true;\r\n\t\t\t}\r\n\t\t\tuni.hideLoading();\r\n\t\t},\r\n\t\tplayClose() {\r\n\t\t\t_self.video.videoUrl = '';\r\n\t\t\t_self.video.videoPoster = '';\r\n\t\t\t_self.isPlay = false; \r\n\t\t},\r\n\t\tvideoError() {\r\n\t\t\t_self.msgData('视频加载失败，可能是暂未下载完成或已删除', 3000);\r\n\t\t}, \r\n\t\t// 创建下载任务\r\n\t\taddDownVideo(downUrl, i) {\r\n\t\t\t//console.log(1)\r\n\t\t\tif(_self.downNum<1){\r\n\t\t\t\t_self.msgData('最多只能同时下载 '+_self.downBigNum+' 个视频', 2000);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t_self.msgData('开始下载', 800);\r\n\t\t\t_self.downNum--;\r\n\t\t\tconst downloadTask = uni.downloadFile({\r\n\t\t\t    url: downUrl,\r\n\t\t\t    success: (res)=> {\r\n\t\t\t\t\t//console.log(res);\r\n\t\t\t        if(res.statusCode === 200) {\r\n\t\t\t            _self.msgData('下载成功');\r\n\t\t\t\t\t\t_self.downList[i]['downkb'] = '下载完成';\r\n\t\t\t\t\t\t_self.downList[i]['downstatus'] = 1;\r\n\t\t\t\t\t\t_self.downNum ++;\r\n\t\t\t\t\t\t// 保存至本地\r\n\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\ttempFilePath: res.tempFilePath,\r\n\t\t\t\t\t\t\tsuccess: (red)=> {\r\n\t\t\t\t\t\t\t\t_self.downList[i]['videourl'] = red.savedFilePath;\r\n\t\t\t\t\t\t\t\tvar where = \"userid=\"+_self.userId+\" and videoid=\"+_self.downList[i]['videoid'];\r\n\t\t\t\t\t\t\t\tvar videoSize = _self.downList[i]['videosize'];\r\n\t\t\t\t\t\t\t\tvar sql = \"update downVideoList set downstatus=1,starttostop=0,downkb='下载完成',videoSize='\"+videoSize+\"',videourl='\"+red.savedFilePath+\"' where \"+where;\r\n\t\t\t\t\t\t\t\tapi.downVideo(sql, 2);\r\n\t\t\t\t\t\t\t\t// 打印路经\r\n\t\t\t\t\t\t\t\t//console.log(red.savedFilePath)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//console.log(2.1)\r\n\t\t\t        }else{\r\n\t\t\t\t\t\t_self.msgData('下载超时，请检查网络是否正常', 3000);\r\n\t\t\t\t\t\t_self.downNum ++;\r\n\t\t\t\t\t\t//downloadTask.abort();\r\n\t\t\t\t\t\t//console.log(2.2)\r\n\t\t\t\t\t}\r\n\t\t\t    },\r\n\t\t\t\tfail: ()=> {\r\n\t\t\t\t\t_self.msgData('下载超时，请检查网络是否正常', 3000);\r\n\t\t\t\t\t_self.downNum++;\r\n\t\t\t\t\t//downloadTask.abort();\r\n\t\t\t\t\t//console.log(3)\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdownloadTask.onProgressUpdate((res) => {\r\n\t\t\t\t//console.log('预期需要下载的数据总长度' + res.totalBytesExpectedToWrite);\r\n\t\t\t\tvar videoSize = res.totalBytesExpectedToWrite/1024/1024;\r\n\t\t\t\t_self.downList[i]['videosize'] = videoSize.toFixed(2);\r\n\t\t\t    //console.log('下载进度' + res.progress);\r\n\t\t\t\t_self.downList[i]['videoing'] = res.progress;\r\n\t\t\t    //console.log('已经下载的数据长度' + res.totalBytesWritten);\r\n\t\t\t\tvar downSize = res.totalBytesWritten/1024/1024;\r\n\t\t\t\t_self.downList[i]['downsize'] = downSize.toFixed(2);\r\n\t\t\t\t//状态\r\n\t\t\t\t_self.downList[i]['downkb'] = '已下载 ' + res.progress + '%';\r\n\t\t\t\t_self.downList[i]['starttostop'] = 0;\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 删除视频\r\n\t\tdelVideo(vid,i,dirPath,downstatus) {\r\n\t\t\tuni.showModal({\r\n\t\t\t    title: '提示',\r\n\t\t\t    content: '确认要删除吗？',\r\n\t\t\t\tcancelText: '点错了',\r\n\t\t\t\tconfirmText: '确定删除',\r\n\t\t\t    success: (res)=> {\r\n\t\t\t        if(res.confirm) {\r\n\t\t\t            api.delDown(_self.userId,vid,dirPath,downstatus);\r\n\t\t\t\t\t\t_self.msgData('删除成功');\r\n\t\t\t\t\t\t_self.downList[i]['delstatus'] = 0;\r\n\t\t\t\t\t\t_self.videoNum--;\r\n\t\t\t\t\t\tif(_self.videoNum < 1) _self.isShowTig = true;\r\n\t\t\t\t\t\t//console.log(_self.videoNum); \r\n\t\t\t        }else if(res.cancel) {\r\n\t\t\t            // console.log('用户点击取消');\r\n\t\t\t        }\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 跳转\r\n\t\tskipUrl(url = '/pages/login/login', type = 1) {\r\n\t\t\tif(type == 1){\r\n\t\t\t\tuni.reLaunch({ url: url });\r\n\t\t\t}else{\r\n\t\t\t\tuni.navigateTo({ url: url });\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 提示\r\n\t\tmsgData(title = '', times = 1000, style = 'none') {\r\n\t\t\t// 加载失败提示\r\n\t\t\tuni.showToast({\r\n\t\t\t\ticon: style,\r\n\t\t\t\ttitle: title,\r\n\t\t\t\tmask: true,\r\n\t\t\t\tduration: times\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t// 下拉刷新\r\n\tonPullDownRefresh() {\r\n\t\t_self.getDownList(); \r\n\t\tuni.stopPullDownRefresh();\r\n\t}\r\n}\n</script>\n\n<style>\r\n.video{\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tbackground: rgba(0,0,0,0.5);\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tpadding: 0 4%;\r\n}\r\n.video video{\r\n\twidth: 92%;\r\n}\r\n.play-title{\r\n\twidth: 90%;\r\n\tmargin-top: 25%;\r\n\tfont-size: 14px;\r\n\tbackground: rgba(0,0,0,0.8);\r\n\ttext-align: left;\r\n\tcolor: #FFFFFF;\r\n\tpadding: 5px 1%;\r\n\tborder-radius: 5px 5px 0 0;\r\n}\r\n.play-close{\r\n\twidth: 92%;\r\n\ttext-align: center;\r\n\tmargin-top: 5px;\r\n}\r\n.play-close image{\r\n\twidth: 30px;\r\n\theight: 30px;\r\n\tborder: 3px solid rgba(239,187,52,0.9);\r\n\tborder-radius: 50%;\r\n}\r\n.bgx{\r\n\twidth: 20px;\r\n\theight: 20px;\r\n\tfloat: right;\r\n\tmargin-top: -5px;\r\n\tmargin-right: -5px;\r\n}\r\n.start-down{\r\n\twidth: 20px;\r\n\theight: 20px;\r\n\tfloat: right;\r\n\tmargin-top: -20px;\r\n\tmargin-right: -5px;\r\n}\r\n.content-head{ \r\n\tposition: fixed;\r\n\twidth: 100%;\r\n\theight: 30px;\r\n\tline-height: 30px;\r\n\ttop: 27px;\r\n\ttext-align: center;\r\n\tcolor: #666666; \r\n}\r\n.video-list{\r\n\tmargin-top: 40upx;\r\n\t//background-color: #007AFF;\r\n}\r\n/* .no{ background: -webkit-gradient(linear, left top, right top, from(rgba(103,103,57,0.6)), to(#ff5e63)); }\r\n.ok{ background: -webkit-gradient(linear, left top, right top, from(rgba(103,103,57,0.6)), to(#33ac55)); } */\r\n.no{ \r\n\t//border: 1px solid #E5E5E5; \r\n}\r\n.ok{ \r\n\t//border: 1px solid rgba(51,172,85,0.5); \r\n}\r\n.video-info{\r\n\tpadding: 10upx 15px;\r\n\twidth: 86%;\r\n\tmargin: 0 auto 10px;\r\n\tborder-radius: 5px;\r\n\t//box-shadow: 0px 4px 6px 0px rgba(103, 103, 103, 0.2);\r\n\tfont-size: 17px;\r\n\tcolor: #666666;\r\n}\r\n.video-info view{ display: inline-block; }\r\n.video-info .img{ \r\n\twidth: 20%;\r\n\theight: 60px; \r\n}\r\n.video-info .img .pic{\r\n\twidth: 200upx;\r\n\theight: 100%;\r\n\tborder-radius: 10upx;\r\n\tbackground: #CCCCCC;\r\n\tmargin-bottom: -4px;\r\n}\r\n.video-info .img .play{\r\n\t//position: absolute;\r\n\tfloat: left;\r\n\twidth: 35px;\r\n\theight: 35px;\r\n\tmargin-left: 70upx;\r\n\tmargin-top: -100upx;\r\n}\r\n.video-content{ \r\n\t// 78%\r\n\twidth: 65%;\r\n\tfloat: right; \r\n}\r\n.video-content view{ display: block; }\r\n.video-title{ \r\n\twidth: 85%;\r\n\tfont-size: 28upx;\r\n\theight: 25px;\r\n\tline-height: 25px;\r\n\toverflow: hidden;\r\n\twhite-space: nowrap;\r\n\ttext-overflow: ellipsis;\r\n\tcolor: #333333; \r\n}\r\n.video-lenght{\r\n\twidth: 85%;\r\n\tfont-size: 3px;\r\n\theight: 3px;\r\n\tline-height: 3px;\r\n\ttext-align: center;\r\n\tborder-radius: 3px;\r\n\tborder: 1px solid #E8E8E8;\r\n}\r\n.video-lenght-ing{ \r\n\tborder-radius: 5px;\r\n\theight: 3px;\r\n\tbackground: rgba(255,12,208,0.8);\r\n\tcolor: #FFFFFF;\r\n}\r\n.video-kb{ \r\n\twidth: 85%;\r\n\tfont-size: 12px;\r\n\theight: 50upx;\r\n\tline-height: 60upx; \r\n\t//background-color: #007AFF;\r\n}\r\n.video-kb view{ display: inline-block; }\n</style>\n","import mod from \"-!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./down.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../thirteen/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./down.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1607585478178\n      var cssReload = require(\"D:/thirteen/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}